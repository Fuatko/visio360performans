module.exports=[24669,a=>{"use strict";let b=(0,a.i(70106).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);a.s(["TrendingUp",()=>b],24669)},46842,a=>{"use strict";let b=(0,a.i(70106).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],46842)},87532,a=>{"use strict";let b=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],87532)},25733,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(11909);var d=a.i(91119),e=a.i(99570),f=a.i(80701),g=a.i(86304),h=a.i(69769),i=a.i(10849),j=a.i(87532),k=a.i(70106);let l=(0,k.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),m=(0,k.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var n=a.i(46842),o=a.i(39761),p=a.i(24669);let q=(0,k.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),r=(0,k.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var s=a.i(96221);function t(){let[a,k]=(0,c.useState)([]),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null);(0,c.useEffect)(()=>{J()},[]),(0,c.useEffect)(()=>{x&&K()},[x,z]);let J=async()=>{let[a,b]=await Promise.all([i.supabase.from("evaluation_periods").select("*").order("created_at",{ascending:!1}),i.supabase.from("organizations").select("*").order("name")]);k(a.data||[]),u(b.data||[])},K=async()=>{let a=i.supabase.from("users").select("*").eq("status","active");z&&(a=a.eq("organization_id",z));let{data:b}=await a.order("name");w(b||[])},L=async()=>{if(!x)return void(0,h.toast)("DÃ¶nem seÃ§in","error");G(!0);try{let a=i.supabase.from("evaluation_assignments").select(`
          *,
          evaluator:evaluator_id(id, name, department),
          target:target_id(id, name, department)
        `).eq("period_id",x).eq("status","completed"),{data:b}=await a;if(!b||0===b.length){E([]),(0,h.toast)("TamamlanmÄ±ÅŸ deÄŸerlendirme bulunamadÄ±","info"),G(!1);return}let c=b.map(a=>a.id),{data:d}=await i.supabase.from("evaluation_responses").select("*").in("assignment_id",c),e={};b.forEach(a=>{let b=a.target_id,c=a.target?.name||"-",f=a.target?.department||"-",g=a.evaluator_id,h=a.evaluator?.name||"-",i=g===b;if(B&&b!==B||z&&a.target?.organization_id!==z)return;e[b]||(e[b]={targetId:b,targetName:c,targetDept:f,evaluations:[],overallAvg:0,selfScore:0,peerAvg:0});let j=(d||[]).filter(b=>b.assignment_id===a.id),k={},l=0,m=0;j.forEach(a=>{let b=a.category_name||"Genel";k[b]||(k[b]={total:0,count:0}),k[b].total+=a.reel_score||a.std_score||0,k[b].count++,l+=a.reel_score||a.std_score||0,m++});let n=Object.entries(k).map(([a,b])=>({name:a,score:b.count>0?Math.round(b.total/b.count*10)/10:0})),o=m>0?Math.round(l/m*10)/10:0;e[b].evaluations.push({evaluatorId:g,evaluatorName:h,isSelf:i,avgScore:o,categories:n})}),Object.values(e).forEach(a=>{let b=a.evaluations.find(a=>a.isSelf),c=a.evaluations.filter(a=>!a.isSelf);a.selfScore=b?.avgScore||0,a.peerAvg=c.length>0?Math.round(c.reduce((a,b)=>a+b.avgScore,0)/c.length*10)/10:0,a.overallAvg=Math.round((.3*a.selfScore+.7*a.peerAvg)*10)/10||a.peerAvg||a.selfScore});let f=Object.values(e).sort((a,b)=>b.overallAvg-a.overallAvg);E(f)}catch(a){console.error("Results error:",a),(0,h.toast)("SonuÃ§lar yÃ¼klenemedi","error")}finally{G(!1)}},M=a=>a>=4?"text-emerald-600":a>=3?"text-blue-600":a>=2?"text-amber-600":"text-red-600",N=a=>a>=4?"success":a>=3?"info":a>=2?"warning":"danger";return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ðŸ“ˆ SonuÃ§lar & Raporlar"}),(0,b.jsx)("p",{className:"text-gray-500 mt-1",children:"DeÄŸerlendirme sonuÃ§larÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin ve analiz edin"})]}),(0,b.jsxs)(d.Card,{className:"mb-6",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"ðŸ” Filtreler"})}),(0,b.jsx)(d.CardBody,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,b.jsxs)("div",{className:"w-64",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DÃ¶nem"}),(0,b.jsx)(f.Select,{options:a.map(a=>({value:a.id,label:a.name})),value:x,onChange:a=>y(a.target.value),placeholder:"DÃ¶nem SeÃ§in"})]}),(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Kurum"}),(0,b.jsx)(f.Select,{options:t.map(a=>({value:a.id,label:a.name})),value:z,onChange:a=>A(a.target.value),placeholder:"TÃ¼m Kurumlar"})]}),(0,b.jsxs)("div",{className:"w-56",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"KiÅŸi"}),(0,b.jsx)(f.Select,{options:v.map(a=>({value:a.id,label:a.name})),value:B,onChange:a=>C(a.target.value),placeholder:"TÃ¼m KiÅŸiler"})]}),(0,b.jsxs)(e.Button,{onClick:L,children:[(0,b.jsx)(j.Search,{className:"w-4 h-4"}),"Filtrele"]}),(0,b.jsxs)(e.Button,{variant:"success",onClick:()=>{if(0===D.length)return void(0,h.toast)("DÄ±ÅŸa aktarÄ±lacak veri yok","error");let a="KiÅŸi,Departman,Ã–z DeÄŸerlendirme,Peer Ortalama,Genel Ortalama,DeÄŸerlendiren SayÄ±sÄ±\n";D.forEach(b=>{a+=`"${b.targetName}","${b.targetDept}",${b.selfScore},${b.peerAvg},${b.overallAvg},${b.evaluations.length}
`});let b=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`sonuclar_${x}.csv`,d.click(),URL.revokeObjectURL(c),(0,h.toast)("Excel dosyasÄ± indirildi","success")},children:[(0,b.jsx)(l,{className:"w-4 h-4"}),"Excel"]})]})})]}),F?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(s.Loader2,{className:"w-8 h-8 animate-spin text-blue-600"})}):0===D.length?(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardBody,{className:"py-12 text-center text-gray-500",children:[(0,b.jsx)(o.BarChart3,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,b.jsx)("p",{children:"SonuÃ§ gÃ¶rmek iÃ§in filtreleri uygulayÄ±n"})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-5 rounded-2xl text-white",children:[(0,b.jsx)(n.User,{className:"w-6 h-6 opacity-80 mb-2"}),(0,b.jsx)("div",{className:"text-3xl font-bold",children:D.length}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"KiÅŸi"})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 p-5 rounded-2xl text-white",children:[(0,b.jsx)(p.TrendingUp,{className:"w-6 h-6 opacity-80 mb-2"}),(0,b.jsx)("div",{className:"text-3xl font-bold",children:(D.reduce((a,b)=>a+b.overallAvg,0)/D.length).toFixed(1)}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"Ortalama Skor"})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-5 rounded-2xl text-white",children:[(0,b.jsx)(o.BarChart3,{className:"w-6 h-6 opacity-80 mb-2"}),(0,b.jsx)("div",{className:"text-3xl font-bold",children:D.reduce((a,b)=>a+b.evaluations.length,0)}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"Toplam DeÄŸerlendirme"})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 p-5 rounded-2xl text-white",children:[(0,b.jsx)(m,{className:"w-6 h-6 opacity-80 mb-2"}),(0,b.jsx)("div",{className:"text-3xl font-bold",children:Math.max(...D.map(a=>a.overallAvg)).toFixed(1)}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"En YÃ¼ksek Skor"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"ðŸ“Š KiÅŸi BazlÄ± SonuÃ§lar"}),(0,b.jsxs)(g.Badge,{variant:"info",children:[D.length," kiÅŸi"]})]}),(0,b.jsx)(d.CardBody,{className:"p-0",children:(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:D.map((a,c)=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 hover:bg-gray-50 cursor-pointer",onClick:()=>I(H===a.targetId?null:a.targetId),children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-semibold text-sm",children:c+1}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:a.targetName}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:a.targetDept})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Ã–z"}),(0,b.jsx)("p",{className:`font-semibold ${M(a.selfScore)}`,children:a.selfScore||"-"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Peer"}),(0,b.jsx)("p",{className:`font-semibold ${M(a.peerAvg)}`,children:a.peerAvg||"-"})]}),(0,b.jsxs)("div",{className:"text-center min-w-[60px]",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Genel"}),(0,b.jsx)(g.Badge,{variant:N(a.overallAvg),children:a.overallAvg})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"DeÄŸerlendiren"}),(0,b.jsx)("p",{className:"font-medium text-gray-700",children:a.evaluations.length})]}),H===a.targetId?(0,b.jsx)(r,{className:"w-5 h-5 text-gray-400"}):(0,b.jsx)(q,{className:"w-5 h-5 text-gray-400"})]})]}),H===a.targetId&&(0,b.jsxs)("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-100",children:[(0,b.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"DeÄŸerlendirme DetaylarÄ±"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.evaluations.map((a,c)=>(0,b.jsxs)("div",{className:`bg-white p-3 rounded-xl border ${a.isSelf?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.isSelf?"ðŸ”µ Ã–z DeÄŸerlendirme":a.evaluatorName}),(0,b.jsx)(g.Badge,{variant:N(a.avgScore),children:a.avgScore})]}),a.categories.length>0&&(0,b.jsx)("div",{className:"space-y-1",children:a.categories.slice(0,3).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-gray-500 truncate",children:a.name}),(0,b.jsx)("span",{className:M(a.score),children:a.score})]},c))})]},c))})]})]},a.targetId))})})]})]})]})}a.s(["default",()=>t],25733)}];

//# sourceMappingURL=_f2dd8d8e._.js.map