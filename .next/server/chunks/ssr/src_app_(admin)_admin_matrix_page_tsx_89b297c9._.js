module.exports=[68572,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(11909);var d=a.i(91119),e=a.i(99570),f=a.i(80701),g=a.i(86304),h=a.i(69769),i=a.i(10849),j=a.i(70106);let k=(0,j.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var l=a.i(87532);let m=(0,j.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);var n=a.i(46842),o=a.i(67900),p=a.i(15618),q=a.i(81560),r=a.i(96221);function s(){let a,j,[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)("list"),[M,N]=(0,c.useState)(!0),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)({total:0,completed:0,pending:0,rate:0});(0,c.useEffect)(()=>{U()},[]),(0,c.useEffect)(()=>{C&&V()},[C,E]);let U=async()=>{try{let[a,b]=await Promise.all([i.supabase.from("evaluation_periods").select("*").order("created_at",{ascending:!1}),i.supabase.from("organizations").select("*").order("name")]);t(a.data||[]),v(b.data||[])}catch(a){console.error("Initial load error:",a)}finally{N(!1)}},V=async()=>{if(C){N(!0);try{let a=i.supabase.from("users").select("*").eq("status","active");E&&(a=a.eq("organization_id",E));let{data:b}=await a.order("department").order("name"),c=b||[];x(c);let d=[...new Set(c.map(a=>a.department).filter(Boolean))];B(d.sort());let e=i.supabase.from("evaluation_assignments").select(`
          *,
          evaluator:evaluator_id(id, name, department, position_level),
          target:target_id(id, name, department, position_level),
          evaluation_periods(name)
        `).eq("period_id",C),{data:f}=await e,g=f||[];z(g);let h=g.length,j=g.filter(a=>"completed"===a.status).length,k=h>0?Math.round(j/h*100):0;T({total:h,completed:j,pending:h-j,rate:k})}catch(a){console.error("Load assignments error:",a),(0,h.toast)("Veriler yÃ¼klenemedi","error")}finally{N(!1)}}},W=y.filter(a=>{let b=a.evaluator?.name?.toLowerCase()||"",c=a.target?.name?.toLowerCase()||"",d=a.evaluator?.department||"",e=a.target?.department||"",f=!G||d===G||e===G,g=!I||b.includes(I.toLowerCase())||c.includes(I.toLowerCase());return f&&g}),X=async()=>{if(!C||!O||!Q)return void(0,h.toast)("DÃ¶nem, deÄŸerlendiren ve deÄŸerlendirilen seÃ§in","error");if(y.find(a=>a.evaluator_id===O&&a.target_id===Q))return void(0,h.toast)("Bu atama zaten mevcut","error");try{let{error:a}=await i.supabase.from("evaluation_assignments").insert({period_id:C,evaluator_id:O,target_id:Q,status:"pending"});if(a)throw a;(0,h.toast)("Atama eklendi","success"),V(),P(""),R("")}catch(a){(0,h.toast)(a.message||"Ekleme hatasÄ±","error")}},Y=async a=>{if(confirm("Bu atamayÄ± silmek istediÄŸinize emin misiniz?"))try{let{error:b}=await i.supabase.from("evaluation_assignments").delete().eq("id",a);if(b)throw b;(0,h.toast)("Atama silindi","success"),V()}catch(a){(0,h.toast)(a.message||"Silme hatasÄ±","error")}};return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ðŸŽ¯ DeÄŸerlendirme Matrisi"}),(0,b.jsx)("p",{className:"text-gray-500 mt-1",children:"KiÅŸi bazlÄ± deÄŸerlendirme atamalarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin ve yÃ¶netin"})]}),(0,b.jsxs)(d.Card,{className:"mb-6",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"ðŸ” Filtreler"})}),(0,b.jsx)(d.CardBody,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,b.jsxs)("div",{className:"w-64",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DÃ¶nem"}),(0,b.jsx)(f.Select,{options:s.map(a=>({value:a.id,label:a.name})),value:C,onChange:a=>D(a.target.value),placeholder:"DÃ¶nem SeÃ§in"})]}),(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Kurum"}),(0,b.jsx)(f.Select,{options:u.map(a=>({value:a.id,label:a.name})),value:E,onChange:a=>F(a.target.value),placeholder:"TÃ¼m Kurumlar"})]}),(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Departman"}),(0,b.jsx)(f.Select,{options:A.map(a=>({value:a,label:a})),value:G,onChange:a=>H(a.target.value),placeholder:"TÃ¼m Departmanlar"})]}),(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"KiÅŸi Ara"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Ä°sim yazÄ±n...",value:I,onChange:a=>J(a.target.value),className:"w-full pl-9 pr-4 py-2.5 text-sm border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"})]})]}),(0,b.jsxs)(e.Button,{onClick:V,variant:"secondary",children:[(0,b.jsx)(k,{className:"w-4 h-4"}),"Yenile"]})]})})]}),C&&(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-5 rounded-2xl text-white",children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:S.total}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"Toplam Atama"})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 p-5 rounded-2xl text-white",children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:S.completed}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"Tamamlanan"})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 p-5 rounded-2xl text-white",children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:S.pending}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"Bekleyen"})]}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-5 rounded-2xl text-white",children:[(0,b.jsxs)("div",{className:"text-3xl font-bold",children:[S.rate,"%"]}),(0,b.jsx)("div",{className:"text-sm opacity-80",children:"Tamamlanma OranÄ±"})]})]}),(0,b.jsxs)(d.Card,{className:"mb-6",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"ðŸ“Š DeÄŸerlendirme Listesi"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{size:"sm",variant:"list"===K?"primary":"secondary",onClick:()=>L("list"),children:[(0,b.jsx)(m,{className:"w-4 h-4"}),"Liste"]}),(0,b.jsxs)(e.Button,{size:"sm",variant:"person"===K?"primary":"secondary",onClick:()=>L("person"),children:[(0,b.jsx)(n.User,{className:"w-4 h-4"}),"KiÅŸi BazlÄ±"]}),(0,b.jsxs)(e.Button,{size:"sm",variant:"dept"===K?"primary":"secondary",onClick:()=>L("dept"),children:[(0,b.jsx)(o.Building2,{className:"w-4 h-4"}),"Departman BazlÄ±"]})]})]}),(0,b.jsx)(d.CardBody,{children:M?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(r.Loader2,{className:"w-8 h-8 animate-spin text-blue-600"})}):C?"list"===K?(0,b.jsxs)("div",{className:"overflow-x-auto",children:[(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50 border-b border-gray-100",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"DeÄŸerlendiren"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"Departman"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-gray-600 text-sm",children:"â†’"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"DeÄŸerlendirilecek"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"Departman"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"TÃ¼r"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"Durum"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-gray-600 text-sm",children:"Ä°ÅŸlem"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-100",children:0===W.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:8,className:"py-12 text-center text-gray-500",children:"Atama bulunamadÄ±"})}):W.map(a=>{let c=a.evaluator_id===a.target_id;return(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"py-3 px-4 font-medium text-gray-900",children:a.evaluator?.name||"-"}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:a.evaluator?.department||"-"}),(0,b.jsx)("td",{className:"py-3 px-4 text-center text-gray-400",children:"â†’"}),(0,b.jsx)("td",{className:"py-3 px-4 font-medium text-gray-900",children:a.target?.name||"-"}),(0,b.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:a.target?.department||"-"}),(0,b.jsx)("td",{className:"py-3 px-4",children:(0,b.jsx)(g.Badge,{variant:c?"info":"gray",children:c?"ðŸ”µ Ã–z":"ðŸ‘¥ Peer"})}),(0,b.jsx)("td",{className:"py-3 px-4",children:(0,b.jsx)(g.Badge,{variant:"completed"===a.status?"success":"warning",children:"completed"===a.status?"âœ… TamamlandÄ±":"â³ Bekliyor"})}),(0,b.jsx)("td",{className:"py-3 px-4 text-right",children:(0,b.jsx)("button",{onClick:()=>Y(a.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",children:(0,b.jsx)(q.Trash2,{className:"w-4 h-4"})})})]},a.id)})})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 mt-4",children:["Toplam ",W.length," atama gÃ¶steriliyor"]})]}):"person"===K?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:Object.entries((a={},W.forEach(b=>{let c=b.evaluator_id,d=b.evaluator?.name||"-",e=b.evaluator?.department||"-";a[c]||(a[c]={name:d,dept:e,willEvaluate:[],willBeEvaluatedBy:[]}),a[c].willEvaluate.push(b)}),W.forEach(b=>{let c=b.target_id,d=b.target?.name||"-",e=b.target?.department||"-";a[c]||(a[c]={name:d,dept:e,willEvaluate:[],willBeEvaluatedBy:[]}),a[c].willBeEvaluatedBy.push(b)}),a)).sort((a,b)=>a[1].name.localeCompare(b[1].name)).map(([a,c])=>{let d=c.willEvaluate.length,e=c.willBeEvaluatedBy.length,f=c.willEvaluate.filter(a=>"completed"===a.status).length;return(0,b.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-gray-900",children:c.name}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:c.dept})]}),(0,b.jsxs)(g.Badge,{variant:"info",children:[f,"/",d]})]}),(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsxs)("p",{className:"text-xs font-semibold text-blue-600 mb-2",children:["ðŸ“¤ DeÄŸerlendirecekleri (",d,")"]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[c.willEvaluate.slice(0,8).map(a=>{let c="completed"===a.status?"#10b981":"#f59e0b",d=a.evaluator_id===a.target_id;return(0,b.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full bg-white border",style:{borderLeftColor:c,borderLeftWidth:3},children:[a.target?.name?.split(" ")[0],d?" (Ã–z)":""]},a.id)}),d>8&&(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:["+",d-8]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-xs font-semibold text-emerald-600 mb-2",children:["ðŸ“¥ DeÄŸerlendirenler (",e,")"]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1",children:[c.willBeEvaluatedBy.slice(0,8).map(a=>{let c="completed"===a.status?"#10b981":"#f59e0b";return(0,b.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-white border",style:{borderLeftColor:c,borderLeftWidth:3},children:a.evaluator?.name?.split(" ")[0]},a.id)}),e>8&&(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:["+",e-8]})]})]})]},a)})}):(0,b.jsx)("div",{className:"space-y-4",children:Object.entries((j={},W.forEach(a=>{let b=a.evaluator?.department||"BelirtilmemiÅŸ";j[b]||(j[b]={assignments:[],persons:new Set,completed:0,pending:0}),j[b].assignments.push(a),j[b].persons.add(a.evaluator_id),"completed"===a.status?j[b].completed++:j[b].pending++}),j)).sort((a,b)=>a[0].localeCompare(b[0])).map(([a,c])=>{let d=c.assignments.length,e=Math.round(c.completed/d*100),f=e>=70?"#10b981":e>=40?"#f59e0b":"#ef4444";return(0,b.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-5",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"font-semibold text-gray-900",children:["ðŸ¢ ",a]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:[c.persons.size," kiÅŸi, ",d," atama"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",style:{color:f},children:[e,"%"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[c.completed,"/",d," tamamlandÄ±"]})]})]}),(0,b.jsx)("div",{className:"bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,b.jsx)("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${e}%`,backgroundColor:f}})})]},a)})}):(0,b.jsx)("p",{className:"text-center text-gray-500 py-12",children:"DÃ¶nem seÃ§erek matris gÃ¶rÃ¼ntÃ¼leyin"})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"âž• Yeni Atama Ekle"})}),(0,b.jsx)(d.CardBody,{children:(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,b.jsxs)("div",{className:"w-56",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DeÄŸerlendiren"}),(0,b.jsx)(f.Select,{options:w.map(a=>({value:a.id,label:`${a.name} (${a.department||"-"})`})),value:O,onChange:a=>P(a.target.value),placeholder:"KiÅŸi SeÃ§in"})]}),(0,b.jsxs)("div",{className:"w-56",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DeÄŸerlendirilecek"}),(0,b.jsx)(f.Select,{options:w.map(a=>({value:a.id,label:`${a.name} (${a.department||"-"})`})),value:Q,onChange:a=>R(a.target.value),placeholder:"KiÅŸi SeÃ§in"})]}),(0,b.jsxs)(e.Button,{onClick:X,variant:"success",children:[(0,b.jsx)(p.Plus,{className:"w-4 h-4"}),"Ekle"]})]})})]})]})}a.s(["default",()=>s,"dynamic",0,"force-dynamic"],68572)}];

//# sourceMappingURL=src_app_%28admin%29_admin_matrix_page_tsx_89b297c9._.js.map