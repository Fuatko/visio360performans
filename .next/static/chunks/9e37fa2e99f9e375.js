(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25652,e=>{"use strict";let a=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>a],25652)},84614,e=>{"use strict";let a=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>a],84614)},55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},89946,e=>{"use strict";var a=e.i(43476),t=e.i(71645);e.i(16787);var s=e.i(15288),r=e.i(19455),l=e.i(67489),i=e.i(87486),d=e.i(73635),n=e.i(7471),c=e.i(55436),o=e.i(75254);let m=(0,o.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),x=(0,o.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var h=e.i(84614),u=e.i(17923),g=e.i(25652);let v=(0,o.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),p=(0,o.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var j=e.i(31278);function f(){let[e,o]=(0,t.useState)([]),[f,y]=(0,t.useState)([]),[b,N]=(0,t.useState)([]),[S,k]=(0,t.useState)(""),[w,C]=(0,t.useState)(""),[A,_]=(0,t.useState)(""),[D,B]=(0,t.useState)([]),[M,z]=(0,t.useState)(!1),[T,E]=(0,t.useState)(null);(0,t.useEffect)(()=>{O()},[]),(0,t.useEffect)(()=>{S&&U()},[S,w]);let O=async()=>{let[e,a]=await Promise.all([n.supabase.from("evaluation_periods").select("*").order("created_at",{ascending:!1}),n.supabase.from("organizations").select("*").order("name")]);o(e.data||[]),y(a.data||[])},U=async()=>{let e=n.supabase.from("users").select("*").eq("status","active");w&&(e=e.eq("organization_id",w));let{data:a}=await e.order("name");N(a||[])},$=async()=>{if(!S)return void(0,d.toast)("DÃ¶nem seÃ§in","error");z(!0);try{let e=n.supabase.from("evaluation_assignments").select(`
          *,
          evaluator:evaluator_id(id, name, department),
          target:target_id(id, name, department)
        `).eq("period_id",S).eq("status","completed"),{data:a}=await e;if(!a||0===a.length){B([]),(0,d.toast)("TamamlanmÄ±ÅŸ deÄŸerlendirme bulunamadÄ±","info"),z(!1);return}let t=a.map(e=>e.id),{data:s}=await n.supabase.from("evaluation_responses").select("*").in("assignment_id",t),r={};a.forEach(e=>{let a=e.target_id,t=e.target?.name||"-",l=e.target?.department||"-",i=e.evaluator_id,d=e.evaluator?.name||"-",n=i===a;if(A&&a!==A||w&&e.target?.organization_id!==w)return;r[a]||(r[a]={targetId:a,targetName:t,targetDept:l,evaluations:[],overallAvg:0,selfScore:0,peerAvg:0});let c=(s||[]).filter(a=>a.assignment_id===e.id),o={},m=0,x=0;c.forEach(e=>{let a=e.category_name||"Genel";o[a]||(o[a]={total:0,count:0}),o[a].total+=e.reel_score||e.std_score||0,o[a].count++,m+=e.reel_score||e.std_score||0,x++});let h=Object.entries(o).map(([e,a])=>({name:e,score:a.count>0?Math.round(a.total/a.count*10)/10:0})),u=x>0?Math.round(m/x*10)/10:0;r[a].evaluations.push({evaluatorId:i,evaluatorName:d,isSelf:n,avgScore:u,categories:h})}),Object.values(r).forEach(e=>{let a=e.evaluations.find(e=>e.isSelf),t=e.evaluations.filter(e=>!e.isSelf);e.selfScore=a?.avgScore||0,e.peerAvg=t.length>0?Math.round(t.reduce((e,a)=>e+a.avgScore,0)/t.length*10)/10:0,e.overallAvg=Math.round((.3*e.selfScore+.7*e.peerAvg)*10)/10||e.peerAvg||e.selfScore});let l=Object.values(r).sort((e,a)=>a.overallAvg-e.overallAvg);B(l)}catch(e){console.error("Results error:",e),(0,d.toast)("SonuÃ§lar yÃ¼klenemedi","error")}finally{z(!1)}},K=e=>e>=4?"text-emerald-600":e>=3?"text-blue-600":e>=2?"text-amber-600":"text-red-600",F=e=>e>=4?"success":e>=3?"info":e>=2?"warning":"danger";return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ðŸ“ˆ SonuÃ§lar & Raporlar"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:"DeÄŸerlendirme sonuÃ§larÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin ve analiz edin"})]}),(0,a.jsxs)(s.Card,{className:"mb-6",children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{children:"ðŸ” Filtreler"})}),(0,a.jsx)(s.CardBody,{children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,a.jsxs)("div",{className:"w-64",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DÃ¶nem"}),(0,a.jsx)(l.Select,{options:e.map(e=>({value:e.id,label:e.name})),value:S,onChange:e=>k(e.target.value),placeholder:"DÃ¶nem SeÃ§in"})]}),(0,a.jsxs)("div",{className:"w-48",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Kurum"}),(0,a.jsx)(l.Select,{options:f.map(e=>({value:e.id,label:e.name})),value:w,onChange:e=>C(e.target.value),placeholder:"TÃ¼m Kurumlar"})]}),(0,a.jsxs)("div",{className:"w-56",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"KiÅŸi"}),(0,a.jsx)(l.Select,{options:b.map(e=>({value:e.id,label:e.name})),value:A,onChange:e=>_(e.target.value),placeholder:"TÃ¼m KiÅŸiler"})]}),(0,a.jsxs)(r.Button,{onClick:$,children:[(0,a.jsx)(c.Search,{className:"w-4 h-4"}),"Filtrele"]}),(0,a.jsxs)(r.Button,{variant:"success",onClick:()=>{if(0===D.length)return void(0,d.toast)("DÄ±ÅŸa aktarÄ±lacak veri yok","error");let e="KiÅŸi,Departman,Ã–z DeÄŸerlendirme,Peer Ortalama,Genel Ortalama,DeÄŸerlendiren SayÄ±sÄ±\n";D.forEach(a=>{e+=`"${a.targetName}","${a.targetDept}",${a.selfScore},${a.peerAvg},${a.overallAvg},${a.evaluations.length}
`});let a=new Blob(["\uFEFF"+e],{type:"text/csv;charset=utf-8"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=`sonuclar_${S}.csv`,s.click(),URL.revokeObjectURL(t),(0,d.toast)("Excel dosyasÄ± indirildi","success")},children:[(0,a.jsx)(m,{className:"w-4 h-4"}),"Excel"]})]})})]}),M?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(j.Loader2,{className:"w-8 h-8 animate-spin text-blue-600"})}):0===D.length?(0,a.jsx)(s.Card,{children:(0,a.jsxs)(s.CardBody,{className:"py-12 text-center text-gray-500",children:[(0,a.jsx)(u.BarChart3,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,a.jsx)("p",{children:"SonuÃ§ gÃ¶rmek iÃ§in filtreleri uygulayÄ±n"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-5 rounded-2xl text-white",children:[(0,a.jsx)(h.User,{className:"w-6 h-6 opacity-80 mb-2"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:D.length}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"KiÅŸi"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 p-5 rounded-2xl text-white",children:[(0,a.jsx)(g.TrendingUp,{className:"w-6 h-6 opacity-80 mb-2"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:(D.reduce((e,a)=>e+a.overallAvg,0)/D.length).toFixed(1)}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Ortalama Skor"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-5 rounded-2xl text-white",children:[(0,a.jsx)(u.BarChart3,{className:"w-6 h-6 opacity-80 mb-2"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:D.reduce((e,a)=>e+a.evaluations.length,0)}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Toplam DeÄŸerlendirme"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 p-5 rounded-2xl text-white",children:[(0,a.jsx)(x,{className:"w-6 h-6 opacity-80 mb-2"}),(0,a.jsx)("div",{className:"text-3xl font-bold",children:Math.max(...D.map(e=>e.overallAvg)).toFixed(1)}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"En YÃ¼ksek Skor"})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsx)(s.CardTitle,{children:"ðŸ“Š KiÅŸi BazlÄ± SonuÃ§lar"}),(0,a.jsxs)(i.Badge,{variant:"info",children:[D.length," kiÅŸi"]})]}),(0,a.jsx)(s.CardBody,{className:"p-0",children:(0,a.jsx)("div",{className:"divide-y divide-gray-100",children:D.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 hover:bg-gray-50 cursor-pointer",onClick:()=>E(T===e.targetId?null:e.targetId),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-semibold text-sm",children:t+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.targetName}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.targetDept})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Ã–z"}),(0,a.jsx)("p",{className:`font-semibold ${K(e.selfScore)}`,children:e.selfScore||"-"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Peer"}),(0,a.jsx)("p",{className:`font-semibold ${K(e.peerAvg)}`,children:e.peerAvg||"-"})]}),(0,a.jsxs)("div",{className:"text-center min-w-[60px]",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Genel"}),(0,a.jsx)(i.Badge,{variant:F(e.overallAvg),children:e.overallAvg})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"DeÄŸerlendiren"}),(0,a.jsx)("p",{className:"font-medium text-gray-700",children:e.evaluations.length})]}),T===e.targetId?(0,a.jsx)(p,{className:"w-5 h-5 text-gray-400"}):(0,a.jsx)(v,{className:"w-5 h-5 text-gray-400"})]})]}),T===e.targetId&&(0,a.jsxs)("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-100",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"DeÄŸerlendirme DetaylarÄ±"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.evaluations.map((e,t)=>(0,a.jsxs)("div",{className:`bg-white p-3 rounded-xl border ${e.isSelf?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.isSelf?"ðŸ”µ Ã–z DeÄŸerlendirme":e.evaluatorName}),(0,a.jsx)(i.Badge,{variant:F(e.avgScore),children:e.avgScore})]}),e.categories.length>0&&(0,a.jsx)("div",{className:"space-y-1",children:e.categories.slice(0,3).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-gray-500 truncate",children:e.name}),(0,a.jsx)("span",{className:K(e.score),children:e.score})]},t))})]},t))})]})]},e.targetId))})})]})]})]})}e.s(["default",()=>f],89946)}]);