(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,27612,e=>{"use strict";var a=e.i(75254);let t=(0,a.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233);let s=(0,a.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>s],27612)},84614,e=>{"use strict";let a=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>a],84614)},55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},27865,e=>{"use strict";var a=e.i(43476),t=e.i(71645);e.i(16787);var s=e.i(15288),l=e.i(19455),r=e.i(67489),i=e.i(87486),d=e.i(73635),n=e.i(7471),c=e.i(75254);let m=(0,c.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var o=e.i(55436);let x=(0,c.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);var h=e.i(84614),p=e.i(7486),u=e.i(7233),y=e.i(27612),g=e.i(31278);function j(){let e,c,[j,v]=(0,t.useState)([]),[b,f]=(0,t.useState)([]),[N,w]=(0,t.useState)([]),[k,C]=(0,t.useState)([]),[B,S]=(0,t.useState)([]),[_,M]=(0,t.useState)(""),[E,z]=(0,t.useState)(""),[D,T]=(0,t.useState)(""),[L,K]=(0,t.useState)(""),[A,H]=(0,t.useState)("list"),[P,q]=(0,t.useState)(!0),[O,$]=(0,t.useState)(""),[U,V]=(0,t.useState)(""),[R,W]=(0,t.useState)({total:0,completed:0,pending:0,rate:0});(0,t.useEffect)(()=>{Y()},[]),(0,t.useEffect)(()=>{_&&F()},[_,E]);let Y=async()=>{try{let[e,a]=await Promise.all([n.supabase.from("evaluation_periods").select("*").order("created_at",{ascending:!1}),n.supabase.from("organizations").select("*").order("name")]);v(e.data||[]),f(a.data||[])}catch(e){console.error("Initial load error:",e)}finally{q(!1)}},F=async()=>{if(_){q(!0);try{let e=n.supabase.from("users").select("*").eq("status","active");E&&(e=e.eq("organization_id",E));let{data:a}=await e.order("department").order("name"),t=a||[];w(t);let s=[...new Set(t.map(e=>e.department).filter(Boolean))];S(s.sort());let l=n.supabase.from("evaluation_assignments").select(`
          *,
          evaluator:evaluator_id(id, name, department, position_level),
          target:target_id(id, name, department, position_level),
          evaluation_periods(name)
        `).eq("period_id",_),{data:r}=await l,i=r||[];C(i);let d=i.length,c=i.filter(e=>"completed"===e.status).length,m=d>0?Math.round(c/d*100):0;W({total:d,completed:c,pending:d-c,rate:m})}catch(e){console.error("Load assignments error:",e),(0,d.toast)("Veriler yÃ¼klenemedi","error")}finally{q(!1)}}},I=k.filter(e=>{let a=e.evaluator?.name?.toLowerCase()||"",t=e.target?.name?.toLowerCase()||"",s=e.evaluator?.department||"",l=e.target?.department||"",r=!D||s===D||l===D,i=!L||a.includes(L.toLowerCase())||t.includes(L.toLowerCase());return r&&i}),G=async()=>{if(!_||!O||!U)return void(0,d.toast)("DÃ¶nem, deÄŸerlendiren ve deÄŸerlendirilen seÃ§in","error");if(k.find(e=>e.evaluator_id===O&&e.target_id===U))return void(0,d.toast)("Bu atama zaten mevcut","error");try{let{error:e}=await n.supabase.from("evaluation_assignments").insert({period_id:_,evaluator_id:O,target_id:U,status:"pending"});if(e)throw e;(0,d.toast)("Atama eklendi","success"),F(),$(""),V("")}catch(e){(0,d.toast)(e.message||"Ekleme hatasÄ±","error")}},J=async e=>{if(confirm("Bu atamayÄ± silmek istediÄŸinize emin misiniz?"))try{let{error:a}=await n.supabase.from("evaluation_assignments").delete().eq("id",e);if(a)throw a;(0,d.toast)("Atama silindi","success"),F()}catch(e){(0,d.toast)(e.message||"Silme hatasÄ±","error")}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ðŸŽ¯ DeÄŸerlendirme Matrisi"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:"KiÅŸi bazlÄ± deÄŸerlendirme atamalarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyin ve yÃ¶netin"})]}),(0,a.jsxs)(s.Card,{className:"mb-6",children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{children:"ðŸ” Filtreler"})}),(0,a.jsx)(s.CardBody,{children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,a.jsxs)("div",{className:"w-64",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DÃ¶nem"}),(0,a.jsx)(r.Select,{options:j.map(e=>({value:e.id,label:e.name})),value:_,onChange:e=>M(e.target.value),placeholder:"DÃ¶nem SeÃ§in"})]}),(0,a.jsxs)("div",{className:"w-48",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Kurum"}),(0,a.jsx)(r.Select,{options:b.map(e=>({value:e.id,label:e.name})),value:E,onChange:e=>z(e.target.value),placeholder:"TÃ¼m Kurumlar"})]}),(0,a.jsxs)("div",{className:"w-48",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Departman"}),(0,a.jsx)(r.Select,{options:B.map(e=>({value:e,label:e})),value:D,onChange:e=>T(e.target.value),placeholder:"TÃ¼m Departmanlar"})]}),(0,a.jsxs)("div",{className:"w-48",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"KiÅŸi Ara"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Ä°sim yazÄ±n...",value:L,onChange:e=>K(e.target.value),className:"w-full pl-9 pr-4 py-2.5 text-sm border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"})]})]}),(0,a.jsxs)(l.Button,{onClick:F,variant:"secondary",children:[(0,a.jsx)(m,{className:"w-4 h-4"}),"Yenile"]})]})})]}),_&&(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-5 rounded-2xl text-white",children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:R.total}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Toplam Atama"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 p-5 rounded-2xl text-white",children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:R.completed}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Tamamlanan"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 p-5 rounded-2xl text-white",children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:R.pending}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Bekleyen"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-5 rounded-2xl text-white",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold",children:[R.rate,"%"]}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Tamamlanma OranÄ±"})]})]}),(0,a.jsxs)(s.Card,{className:"mb-6",children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsx)(s.CardTitle,{children:"ðŸ“Š DeÄŸerlendirme Listesi"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Button,{size:"sm",variant:"list"===A?"primary":"secondary",onClick:()=>H("list"),children:[(0,a.jsx)(x,{className:"w-4 h-4"}),"Liste"]}),(0,a.jsxs)(l.Button,{size:"sm",variant:"person"===A?"primary":"secondary",onClick:()=>H("person"),children:[(0,a.jsx)(h.User,{className:"w-4 h-4"}),"KiÅŸi BazlÄ±"]}),(0,a.jsxs)(l.Button,{size:"sm",variant:"dept"===A?"primary":"secondary",onClick:()=>H("dept"),children:[(0,a.jsx)(p.Building2,{className:"w-4 h-4"}),"Departman BazlÄ±"]})]})]}),(0,a.jsx)(s.CardBody,{children:P?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(g.Loader2,{className:"w-8 h-8 animate-spin text-blue-600"})}):_?"list"===A?(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"DeÄŸerlendiren"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"Departman"}),(0,a.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-gray-600 text-sm",children:"â†’"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"DeÄŸerlendirilecek"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"Departman"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"TÃ¼r"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-600 text-sm",children:"Durum"}),(0,a.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-gray-600 text-sm",children:"Ä°ÅŸlem"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-100",children:0===I.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:8,className:"py-12 text-center text-gray-500",children:"Atama bulunamadÄ±"})}):I.map(e=>{let t=e.evaluator_id===e.target_id;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4 font-medium text-gray-900",children:e.evaluator?.name||"-"}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.evaluator?.department||"-"}),(0,a.jsx)("td",{className:"py-3 px-4 text-center text-gray-400",children:"â†’"}),(0,a.jsx)("td",{className:"py-3 px-4 font-medium text-gray-900",children:e.target?.name||"-"}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.target?.department||"-"}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(i.Badge,{variant:t?"info":"gray",children:t?"ðŸ”µ Ã–z":"ðŸ‘¥ Peer"})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(i.Badge,{variant:"completed"===e.status?"success":"warning",children:"completed"===e.status?"âœ… TamamlandÄ±":"â³ Bekliyor"})}),(0,a.jsx)("td",{className:"py-3 px-4 text-right",children:(0,a.jsx)("button",{onClick:()=>J(e.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",children:(0,a.jsx)(y.Trash2,{className:"w-4 h-4"})})})]},e.id)})})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-4",children:["Toplam ",I.length," atama gÃ¶steriliyor"]})]}):"person"===A?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:Object.entries((e={},I.forEach(a=>{let t=a.evaluator_id,s=a.evaluator?.name||"-",l=a.evaluator?.department||"-";e[t]||(e[t]={name:s,dept:l,willEvaluate:[],willBeEvaluatedBy:[]}),e[t].willEvaluate.push(a)}),I.forEach(a=>{let t=a.target_id,s=a.target?.name||"-",l=a.target?.department||"-";e[t]||(e[t]={name:s,dept:l,willEvaluate:[],willBeEvaluatedBy:[]}),e[t].willBeEvaluatedBy.push(a)}),e)).sort((e,a)=>e[1].name.localeCompare(a[1].name)).map(([e,t])=>{let s=t.willEvaluate.length,l=t.willBeEvaluatedBy.length,r=t.willEvaluate.filter(e=>"completed"===e.status).length;return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:t.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:t.dept})]}),(0,a.jsxs)(i.Badge,{variant:"info",children:[r,"/",s]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("p",{className:"text-xs font-semibold text-blue-600 mb-2",children:["ðŸ“¤ DeÄŸerlendirecekleri (",s,")"]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[t.willEvaluate.slice(0,8).map(e=>{let t="completed"===e.status?"#10b981":"#f59e0b",s=e.evaluator_id===e.target_id;return(0,a.jsxs)("span",{className:"text-xs px-2 py-1 rounded-full bg-white border",style:{borderLeftColor:t,borderLeftWidth:3},children:[e.target?.name?.split(" ")[0],s?" (Ã–z)":""]},e.id)}),s>8&&(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["+",s-8]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-xs font-semibold text-emerald-600 mb-2",children:["ðŸ“¥ DeÄŸerlendirenler (",l,")"]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[t.willBeEvaluatedBy.slice(0,8).map(e=>{let t="completed"===e.status?"#10b981":"#f59e0b";return(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-white border",style:{borderLeftColor:t,borderLeftWidth:3},children:e.evaluator?.name?.split(" ")[0]},e.id)}),l>8&&(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["+",l-8]})]})]})]},e)})}):(0,a.jsx)("div",{className:"space-y-4",children:Object.entries((c={},I.forEach(e=>{let a=e.evaluator?.department||"BelirtilmemiÅŸ";c[a]||(c[a]={assignments:[],persons:new Set,completed:0,pending:0}),c[a].assignments.push(e),c[a].persons.add(e.evaluator_id),"completed"===e.status?c[a].completed++:c[a].pending++}),c)).sort((e,a)=>e[0].localeCompare(a[0])).map(([e,t])=>{let s=t.assignments.length,l=Math.round(t.completed/s*100),r=l>=70?"#10b981":l>=40?"#f59e0b":"#ef4444";return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-5",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-semibold text-gray-900",children:["ðŸ¢ ",e]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[t.persons.size," kiÅŸi, ",s," atama"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",style:{color:r},children:[l,"%"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[t.completed,"/",s," tamamlandÄ±"]})]})]}),(0,a.jsx)("div",{className:"bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${l}%`,backgroundColor:r}})})]},e)})}):(0,a.jsx)("p",{className:"text-center text-gray-500 py-12",children:"DÃ¶nem seÃ§erek matris gÃ¶rÃ¼ntÃ¼leyin"})})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{children:"âž• Yeni Atama Ekle"})}),(0,a.jsx)(s.CardBody,{children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,a.jsxs)("div",{className:"w-56",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DeÄŸerlendiren"}),(0,a.jsx)(r.Select,{options:N.map(e=>({value:e.id,label:`${e.name} (${e.department||"-"})`})),value:O,onChange:e=>$(e.target.value),placeholder:"KiÅŸi SeÃ§in"})]}),(0,a.jsxs)("div",{className:"w-56",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"DeÄŸerlendirilecek"}),(0,a.jsx)(r.Select,{options:N.map(e=>({value:e.id,label:`${e.name} (${e.department||"-"})`})),value:U,onChange:e=>V(e.target.value),placeholder:"KiÅŸi SeÃ§in"})]}),(0,a.jsxs)(l.Button,{onClick:G,variant:"success",children:[(0,a.jsx)(u.Plus,{className:"w-4 h-4"}),"Ekle"]})]})})]})]})}e.s(["default",()=>j,"dynamic",0,"force-dynamic"],27865)}]);